## Prison

- 题目描述：

  > 你的发现触动了某些人的利益，他们将你囚禁了起来。为了活下去，你必须逃离这里！ 
  >
  > **flag格式：flag{你的逃跑路线}** 
  >
  > By *?*

 - 题目附件：[attachment.zip](https://cdn.jsdelivr.net/gh/SignorMercurio/MetasequoiaCTF@master/Reverse/Prison/attachment.zip)

 - 考察点：逆向分析地图题

 - 难度：中等

 - 初始分值：350

 - 最终分值：335

 - 完成人数：4

走迷宫，地图是乱序给的，需要重新整理一下：

```python
#!/usr/bin/python
#__author__:TaQini

map = {0:"**########################################################################################",
10:"#************######*##############**************##*####*#######*##*##*###*#####*####*#####",
22:"###*#########*****************************************************************############",
24:"###*#########*###############################################*######*****************#####",
21:"###**********#############################################################################",
1:"#*######################*******************************************#####*************#####",
20:"############*#####*******************************************************************#####",
15:"###*#################################################*#########*##*######*#####*####*#####",
16:"###*####*****#####**********************#############*#########*##********#####*####*#####",
2:"#************************####*####################################*#####*###########*#####",
18:"###*####*###*#####*############################################*****************####*#####",
17:"###*####*###*#####*####################***************#########*###############*####*#####",
3:"#########*#########*#########*#######***************************##*#####*###########*#####",
26:"#############################################################*######*#####################",
4:"#******##*#########*#########*#######*#########################*##*#####*###########*#####",
5:"#*####*##*#########*#########*#######*#########################*##*#####********####*#####",
19:"###******###*#####*#################################################################*#####",
23:"###*#########*###############################################*############################",
6:"#*####*##*#########*######*******####*###**********####****####*##*############*####*#####",
7:"#*##***#**#########*#################*###*########*####*#######*##*############*####*#####",
25:"###**************************************************########*######*#####################",
8:"#*##*###*##########*##############****###*******##*####*#######*##*##*****#####*####*#####",
9:"#*##*###*##########*##############*############*##*####*#######*##*##*###*#####*####*#####",
11:"###################*##############################*####***#####*##*##*###*#####*####*#####",
12:"###################********************************############*##*##*###*#####*####*#####",
13:"###############################################################*##*##*###*#####*####*#####",
28:"#########################*****************************************************************",
14:"###***************************************************#########*##*##*###*#####*####*#####",
27:"#############################################################*######*#####################",
29:"#*#######*####**###*#######***#######*########**###*******##*****##########################",
30:"##*#####*###*###*##*######*#########*#*######*##*#####*#####*##############################",
31:"###*###*####*###*##*######*##**####*###*####*#########*#####***############################",
32:"####*#*#####*###*##*##*###*###*###*******####*##*#####*#####*##############################",
33:"#####*#######**####****####**####*#######*####**######*#####*##############################"}

for i in range(34):
    print map[i]
```

得到迷宫：

```
**########################################################################################
#*######################*******************************************#####*************#####
#************************####*####################################*#####*###########*#####
#########*#########*#########*#######***************************##*#####*###########*#####
#******##*#########*#########*#######*#########################*##*#####*###########*#####
#*####*##*#########*#########*#######*#########################*##*#####********####*#####
#*####*##*#########*######*******####*###**********####****####*##*############*####*#####
#*##***#**#########*#################*###*########*####*#######*##*############*####*#####
#*##*###*##########*##############****###*******##*####*#######*##*##*****#####*####*#####
#*##*###*##########*##############*############*##*####*#######*##*##*###*#####*####*#####
#************######*##############**************##*####*#######*##*##*###*#####*####*#####
###################*##############################*####***#####*##*##*###*#####*####*#####
###################********************************############*##*##*###*#####*####*#####
###############################################################*##*##*###*#####*####*#####
###***************************************************#########*##*##*###*#####*####*#####
###*#################################################*#########*##*######*#####*####*#####
###*####*****#####**********************#############*#########*##********#####*####*#####
###*####*###*#####*####################***************#########*###############*####*#####
###*####*###*#####*############################################*****************####*#####
###******###*#####*#################################################################*#####
############*#####*******************************************************************#####
###**********#############################################################################
###*#########*****************************************************************############
###*#########*###############################################*############################
###*#########*###############################################*######*****************#####
###**************************************************########*######*#####################
#############################################################*######*#####################
#############################################################*######*#####################
#########################*****************************************************************
```

耐心走完即可：

```python
#!/usr/bin/python
#__author__:TaQini

raw='r1,d2,r18,d10,r31,u6,l9,d2,r6,d2,l13,u2,r3,u5,r26,d15,r16,u13,l7,u4,r12,d19,l66,u4,r21,d1,r14,u3,l50,d5,r5,u3,r4,d5,l9,d4,r10,u3,r48,d6,r28'

flag = ''

for i in raw.split(','):
    op=i[0]
    tm=i[1:]
    flag+=op*eval(tm)

print "flag{%s}"%flag.upper()
```

> flag{RDDRRRRRRRRRRRRRRRRRRDDDDDDDDDDRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRUUUUUULLLLLLLLLDDRRRRRRDDLLLLLLLLLLLLLUURRRUUUUURRRRRRRRRRRRRRRRRRRRRRRRRRDDDDDDDDDDDDDDDRRRRRRRRRRRRRRRRUUUUUUUUUUUUULLLLLLLUUUURRRRRRRRRRRRDDDDDDDDDDDDDDDDDDDLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLUUUURRRRRRRRRRRRRRRRRRRRRDRRRRRRRRRRRRRRUUULLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLDDDDDRRRRRUUURRRRDDDDDLLLLLLLLLDDDDRRRRRRRRRRUUURRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRDDDDDDRRRRRRRRRRRRRRRRRRRRRRRRRRRR}

