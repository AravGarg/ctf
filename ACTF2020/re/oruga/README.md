## oruga

- 走迷宫的小游戏，只要逆出了游戏规则就简单了...(有点像是神奇宝贝绿宝石里面那个溜冰游戏...)

- 游戏地图大小为16x16，如下(其中`.`代表`\x00`)：

  ```
  ....#.......####
  ...##...OO......
  ........OO.PP...
  ...L.OO.OO.PP...
  ...L.OO.OO.P....
  ..LL.OO....P....
  .....OO....P....
  #...............
  ............#...
  ......MMM...#...
  .......MMM....EE
  ...0.M.M.M....E.
  ..............EE
  TTTI.M.M.M....E.
  .T.I.M.M.M....E.
  .T.I.M.M.M!...EE
  ```

- 游戏规则如下：

  1. 地图中`.`(`\x00`)表示可走的路，`！`表示终点，其余的字符表示障碍物
  2. 起点为(0,0)
  3. 每次选择一个方向，一直走到遇到障碍物为止
  4. 走出上下左右任何一个边界，即判负
  5. 走到终点，赢得游戏

- 通过输入字符表示上下左右方向，对应规则如下：

  ```
  W - Up
  E - Right
  M - Down
  J - Left
  ```

- 按照游戏规则走到终点即可（`MEWEMEWJMEWJM`）

- 下面分析上述规则对应的代码：

- 规则1,2,5比较容易，看地图就能猜出来

- 规则3,4代码如下：

  ```C
  while ( !map[ptr] )                           // add op while map[ptr] is NULL
  {
      if ( op == -1 && !(ptr & 0xF) )           // LEFT  - not 0,16,32... (col 0)
          return 0LL;
      if ( op == 1 && ptr % 16 == 15 )          // RIGHT - not 15,31,47...(col 15)
          return 0LL;
      if ( op == 16 && (ptr - 240) <= 0xF )     // DOWN  - not <= 255 (row 15)
          return 0LL;
      if ( op == -16 && (ptr + 15) <= 0x1E )    // UP    - not <= 15  (row 0)
          return 0LL;
      ptr += op;
  }
  ```

  其中`while ( !map[ptr] )  `对应规则3

  循环中的代码为边界检查，对应规则4